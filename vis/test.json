{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "dataset/clean.csv"
  },
  "transform": [
    {"filter": {"selection": "year"}},
    {"filter": {"selection": "region"}},
    {"calculate": "datum.Sex == 'Female' ? datum.Total : 0", "as": "Female"},
    {"calculate": "datum.Sex == 'Male' ? datum.Total : 0", "as": "Male"},
    {"aggregate": [{"op": "sum", "field": "Female", "as": "TotalFemale"}, {"op": "sum", "field": "Male", "as": "TotalMale"}]}
  ],
  "selection": {
    "year": {"type": "single", "fields": ["Year"], "bind": {"input": "select", "options": [2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010]}},
    "region": {"type": "single", "fields": ["Region"], "bind": {"input": "radio", "options": ["Africa", "Asia", "Americas", "Oceania", "Europe"]}}
  },
  "mark": "bar",
  "encoding": {
    "x": {"field": "Region", "type": "nominal", "axis": {"title": "Region"}},
    "y": {
      "field": "TotalFemale",
      "type": "quantitative",
      "title": "Female Prisoners",
      "stack": "normalize"
    },
    "color": {"field": "Sex", "type": "nominal", "scale": {"range": ["#1f77b4", "#ff7f0e"]}}
  }
}
